(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{67:function(){},2061:function(){},8588:function(e,r,a){Promise.resolve().then(a.bind(a,5024))},5024:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return D}});var t=a(7437),s=a(2265),l=a(6463),o=a(8370),d=a(7818),n=a(9842),i=a(5344),c=function(){let[e,r]=(0,s.useState)([]);(0,s.useEffect)(()=>{(async()=>{let e=(0,n.IO)((0,n.hJ)(i.Z,"geofence"));r((await (0,n.PL)(e)).docs.map(e=>({id:e.id,...e.data()})))})()},[]);let[a,l]=(0,s.useState)({id:"",password:"",name:"",class:"employee",title:"Administrative Officer",gender:"male",email:"",cell:"",address:"",workHours:{Monday:{start:"",end:""},Tuesday:{start:"",end:""},Wednesday:{start:"",end:""},Thursday:{start:"",end:""},Friday:{start:"",end:""},Saturday:{start:"",end:""},Sunday:{start:"",end:""}},workPeriod:[],geofence:null}),o=e=>{let{name:r,value:a}=e.target;if(r.includes(".start")||r.includes(".end")){let[e,t]=r.split(".");l(r=>({...r,workHours:{...r.workHours,[e]:{...r.workHours[e],[t]:a}}}))}else l(e=>({...e,[r]:a}))},d=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(e).toLowerCase()),c=()=>{for(let e in a.workHours){let r=a.workHours[e].start,t=a.workHours[e].end;if(r&&t&&new Date("1970-01-01T".concat(t))<new Date("1970-01-01T".concat(r)))return alert("".concat(e,": End time cannot be earlier than start time.")),!1}return!0},u=async()=>{let e=(0,n.IO)((0,n.hJ)(i.Z,"employee"),(0,n.ar)("id","==",a.id)),r=(0,n.IO)((0,n.hJ)(i.Z,"employee"),(0,n.ar)("email","==",a.email)),t=await (0,n.PL)(e),s=await (0,n.PL)(r);return t.empty?!!s.empty||(alert("Email already exists"),!1):(alert("Employee ID already exists"),!1)},g=async e=>{if(e.preventDefault(),c()){if(!d(a.email)){alert("Invalid email format");return}if(await u())try{let e=Object.keys(a.workHours).reduce((e,r)=>(e[r]="".concat(a.workHours[r].start," - ").concat(a.workHours[r].end),e),{});await (0,n.ET)((0,n.hJ)(i.Z,"employee"),{...a,workHours:e}),alert("Employee added successfully!"),l({id:"",password:"",name:"",class:"employee",title:"Administrative Officer",gender:"male",email:"",cell:"",address:"",workHours:{Monday:{start:"",end:""},Tuesday:{start:"",end:""},Wednesday:{start:"",end:""},Thursday:{start:"",end:""},Friday:{start:"",end:""},Saturday:{start:"",end:""},Sunday:{start:"",end:""}},workPeriod:[],geofence:""})}catch(e){console.error("Error adding document: ",e),alert("Error adding employee."+e)}}};return(0,t.jsxs)("div",{className:"p-6 max-w-3xl mx-auto bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100",children:"Register Employee"}),(0,t.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",id:"id",name:"id",placeholder:"ID",value:a.id,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm placeholder-transparent focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none"}),(0,t.jsx)("label",{htmlFor:"id",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"ID"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"password",id:"password",name:"password",placeholder:"Password",value:a.password,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm placeholder-transparent focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none"}),(0,t.jsx)("label",{htmlFor:"password",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Password"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",id:"name",name:"name",placeholder:"Name",value:a.name,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm placeholder-transparent focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none"}),(0,t.jsx)("label",{htmlFor:"name",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Name"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{id:"class",name:"class",value:a.class,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none",children:[(0,t.jsx)("option",{value:"employee",children:"Employee"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]}),(0,t.jsx)("label",{htmlFor:"class",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Employee Type"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{id:"title",name:"title",value:a.title,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none",children:[(0,t.jsx)("option",{value:"Administrative Officer",children:"Administrative Officer"}),(0,t.jsx)("option",{value:"Manager",children:"Manager"}),(0,t.jsx)("option",{value:"Clerk",children:"Clerk"})]}),(0,t.jsx)("label",{htmlFor:"title",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Title"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{id:"gender",name:"gender",value:a.gender,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none",children:[(0,t.jsx)("option",{value:"male",children:"Male"}),(0,t.jsx)("option",{value:"female",children:"Female"}),(0,t.jsx)("option",{value:"non-binary",children:"Non-binary"})]}),(0,t.jsx)("label",{htmlFor:"gender",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Gender"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"email",id:"email",name:"email",placeholder:"Email",value:a.email,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm placeholder-transparent focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none"}),(0,t.jsx)("label",{htmlFor:"email",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Email"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",id:"cell",name:"cell",placeholder:"Cell Number",value:a.cell,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm placeholder-transparent focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none"}),(0,t.jsx)("label",{htmlFor:"cell",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Cell Number"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",id:"address",name:"address",placeholder:"Address",value:a.address,onChange:o,required:!0,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm placeholder-transparent focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none"}),(0,t.jsx)("label",{htmlFor:"address",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Address"})]}),Object.keys(a.workHours).map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-1/4",children:(0,t.jsx)("label",{htmlFor:"".concat(e,"-start"),className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:e})}),(0,t.jsx)("input",{type:"time",id:"".concat(e,"-start"),name:"".concat(e,".start"),value:a.workHours[e].start,onChange:o,required:!0,className:"w-1/2 p-2 border border-gray-500 dark:border-gray-600 bg-gray-200 dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-lg"}),(0,t.jsx)("span",{className:"mx-2 text-gray-700 dark:text-gray-300",children:"to"}),(0,t.jsx)("input",{type:"time",id:"".concat(e,"-end"),name:"".concat(e,".end"),value:a.workHours[e].end,onChange:o,required:!0,className:"w-1/2 p-2 border border-gray-500 dark:border-gray-600 bg-gray-200 dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-lg"})]},e)),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{id:"geofence",name:"geofence",value:a.geofence,onChange:o,className:"peer p-4 block w-full bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:border-blue-400 dark:focus:ring-blue-400 disabled:opacity-50 disabled:pointer-events-none",children:[(0,t.jsx)("option",{value:"",children:"Select Geofence"}),e.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,t.jsx)("label",{htmlFor:"geofence",className:"absolute top-0 left-0 p-4 h-full text-sm truncate pointer-events-none transition-all duration-300 transform origin-top-left peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-gray-500 dark:peer-placeholder-shown:text-gray-400 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:text-blue-500 dark:peer-focus:text-blue-400",children:"Geofence"})]}),(0,t.jsx)("button",{type:"submit",className:"w-full py-2 px-4 bg-blue-600 dark:bg-blue-700 text-white dark:text-gray-100 font-semibold rounded-lg shadow-md hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",children:"Register"})]})]})},u=a(7170),g=a(7800),m=a(9450),x=function(e){let{onEdit:r}=e,[a,l]=(0,s.useState)([]),[o,d]=(0,s.useState)(""),[c,x]=(0,s.useState)("all"),[h,y]=(0,s.useState)(""),[p,b]=(0,s.useState)(""),k=(0,s.useCallback)(async()=>{l((await (0,n.PL)((0,n.hJ)(i.Z,"employee"))).docs.map(e=>({id:e.id,...e.data()})))},[]);(0,s.useEffect)(()=>{k()},[k]);let f=e=>{let r=(e/60).toFixed(1);return"".concat(r,"h")},w=m.ou.now().setZone("America/Edmonton").toFormat("cccc"),j=a.filter(e=>{let r=""===o||Object.values(e).some(e=>e.toString().toLowerCase().includes(o)),a="online"===e.status;e.workDurationToday;let t=e.workHours&&" - "!==e.workHours[w],s="all"===c||"online"===c&&a||"workingToday"===c&&t||"offToday"===c&&!t;return r&&s}),N=(()=>{let e=[];for(let r=6;r>=0;r--)e.push(m.ou.now().minus({days:r}).toISODate());return e})();return(0,t.jsxs)("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search employees...",value:o,onChange:e=>{d(e.target.value.toLowerCase())},className:"p-2 border rounded-md w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 w-full md:w-auto",children:[(0,t.jsxs)("select",{value:c,onChange:e=>{x(e.target.value)},className:"p-2 border rounded-md w-full md:w-1/4 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",children:[(0,t.jsx)("option",{value:"all",children:"Show All"}),(0,t.jsx)("option",{value:"online",children:"Online Only"}),(0,t.jsx)("option",{value:"workingToday",children:"Working Today"}),(0,t.jsx)("option",{value:"offToday",children:"Off Today"})]}),(0,t.jsx)("input",{type:"date",value:h,onChange:e=>{y(e.target.value)},className:"p-2 border rounded-md w-full md:w-1/4 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"}),(0,t.jsx)("input",{type:"date",value:p,onChange:e=>{b(e.target.value)},className:"p-2 border rounded-md w-full md:w-1/4 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"}),(0,t.jsx)("button",{onClick:()=>{if(!h||!p||m.ou.fromISO(h)>m.ou.fromISO(p)){alert("Please select a valid start and end date.");return}let e=m.ou.fromISO(h).startOf("day"),r=m.ou.fromISO(p).endOf("day"),t=[];for(let a=e;a<=r;a=a.plus({days:1}))t.push(a.toISODate());let s=a.map(e=>{let r=e.workPeriod||{},a=e.workTime||{},s=t.map(e=>{let t=a[e]?a[e]:"N/A",s=r[e]?r[e]:0;return{date:e,workEntry:t,duration:s}}),l=f(s.reduce((e,r)=>{let{duration:a}=r;return e+a},0));return{ID:e.id,Name:e.name,dailyDurations:s,Total:l}}),l=[["ID","Name",...t,"Total"]];s.forEach(e=>{let r=[e.ID,e.Name],a=["",""],t=["",""];e.dailyDurations.forEach(e=>{let{date:s,workEntry:l,duration:o}=e;r.push(s),a.push(l),t.push(f(o))}),r.push(""),a.push(""),t.push(e.Total),l.push(r),l.push(a),l.push(t),l.push([])});let o=g.P6.aoa_to_sheet(l),d=[{wpx:50},{wpx:110},...t.map(()=>({wpx:150})),{wpx:100}];o["!cols"]=d;let n=g.P6.book_new();g.P6.book_append_sheet(n,o,"Employees");let i=new Blob([g.cW(n,{bookType:"xlsx",type:"array"})],{type:"application/octet-stream"});(0,u.saveAs)(i,"employees.xlsx")},className:"p-2 bg-green-600 text-white rounded-md hover:bg-green-500 dark:bg-green-700 dark:hover:bg-green-600 w-full md:w-auto",children:"Export Employee List"})]})]}),(0,t.jsx)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:j.map(e=>(0,t.jsxs)("div",{className:"p-4 bg-white dark:bg-gray-700 rounded-lg shadow-md text-center",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-2 dark:text-gray-100",children:[e.name," - ",e.title]}),(0,t.jsxs)("p",{className:"text-sm mb-2 dark:text-gray-200",children:["Status:"," ",(0,t.jsx)("span",{className:"font-bold ".concat("online"===e.status?"text-green-500":"text-gray-500 dark:text-gray-400"),children:"online"===e.status?"Online":"Offline"})]}),(0,t.jsxs)("p",{className:"text-sm mb-2 dark:text-gray-200",children:["Today's Work Hours:"," ",f(e.workDurationToday)]}),(0,t.jsxs)("p",{className:"text-sm mb-4 dark:text-gray-200",children:["This Month's Work Hours:"," ",f(e.thisMonthWorkDuration||0)]}),(0,t.jsx)("button",{onClick:()=>r(e),className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-500 dark:bg-blue-700 dark:hover:bg-blue-600",children:"Edit"})]},e.id))}),(0,t.jsx)("div",{className:"mt-6 overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full border-collapse bg-gray-100 dark:bg-gray-800",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"border p-2 dark:bg-gray-700 dark:text-gray-300",children:"ID"}),(0,t.jsx)("th",{className:"border p-2 dark:bg-gray-700 dark:text-gray-300",children:"Name"}),(0,t.jsx)("th",{className:"border p-2 dark:bg-gray-700 dark:text-gray-300",children:"Title"}),N.map(e=>(0,t.jsx)("th",{className:"border p-2 dark:bg-gray-700 dark:text-gray-300",children:e},e)),(0,t.jsx)("th",{className:"border p-2 dark:bg-gray-700 dark:text-gray-300",children:"Total"})]})}),(0,t.jsx)("tbody",{children:j.map(e=>{let r=N.reduce((r,a)=>r+(e.workPeriod&&e.workPeriod[a]||0),0);return(0,t.jsxs)("tr",{className:"dark:text-gray-200",children:[(0,t.jsx)("td",{className:"border p-2",children:e.id}),(0,t.jsx)("td",{className:"border p-2",children:e.name}),(0,t.jsx)("td",{className:"border p-2",children:e.title}),N.map(r=>(0,t.jsx)("td",{className:"border p-2",children:e.workPeriod&&e.workPeriod[r]||"0"},r)),(0,t.jsx)("td",{className:"border p-2",children:f(r)})]},e.id)})})]})})]})},h=a(7346);a(433);var y=function(){let[e,r]=(0,s.useState)([]),[a,l]=(0,s.useState)([]),[o,d]=(0,s.useState)(""),[c,u]=(0,s.useState)(0),[g,x]=(0,s.useState)([]),[y,p]=(0,s.useState)(0),[b,k]=(0,s.useState)(0),[f,w]=(0,s.useState)({hours:0,minutes:0}),[j,N]=(0,s.useState)([]),[v,D]=(0,s.useState)(null),_=(0,s.useCallback)(async()=>{let e=(await (0,n.PL)((0,n.hJ)(i.Z,"employee"))).docs.map(e=>e.data()),a=m.ou.now(),t=a.minus({days:6}).startOf("day"),s=a.endOf("day"),o=[];for(let e=t;e<=s;e=e.plus({days:1}))o.push(e.toFormat("yyyy-MM-dd"));let d=e.filter(e=>{let r=e.workHours&&e.workHours[a.weekdayLong];return r&&" - "!==r}),c=d.filter(e=>"online"===e.status),g=e.reduce((e,r)=>e+(r.workDurationToday||0),0)/e.length,h=e.map(e=>{let r=e.workPeriod||{},a=o.map(e=>(r[e]||0)/60);return{name:e.name,workHours:a}});r(e),l(e),u(d.length),x(d),p(c.length),k(e.length),w({hours:Math.floor(g/60),minutes:Math.floor(g%60)}),N(h)},[]);(0,s.useEffect)(()=>{_()},[_]);let C={labels:Array.from({length:7},(e,r)=>m.ou.now().minus({days:6-r}).toFormat("yyyy-MM-dd")),datasets:v?[{label:v.name,data:v.workHours,fill:!0,borderColor:"#4caf50",backgroundColor:"rgba(76, 175, 80, 0.2)"}]:[]},W={labels:Array.from({length:7},(e,r)=>m.ou.now().minus({days:6-r}).toFormat("yyyy-MM-dd")),datasets:[{label:"Average Weekly Work Hours",data:j.reduce((e,r)=>(r.workHours.forEach((r,a)=>{e[a]=(e[a]||0)+r}),e),[]).map(e=>e/j.length/60),backgroundColor:"#007bff"}]},S=e=>{D(j.find(r=>r.name===e.name))};return(0,t.jsxs)("div",{className:"flex flex-col gap-4 p-4 bg-gray-800 dark:bg-gray-900",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-5 mb-5",children:[(0,t.jsxs)("div",{className:"bg-blue-600 text-white p-5 rounded-lg shadow-lg flex-1 min-w-[250px] flex flex-col items-center justify-center text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Today's Work Count"}),(0,t.jsxs)("p",{className:"text-xl",children:[c,"/",b]})]}),(0,t.jsxs)("div",{className:"bg-yellow-400 text-black p-5 rounded-lg shadow-lg flex-1 min-w-[250px] flex flex-col items-center justify-center text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Employees Working Today"}),(0,t.jsx)("ul",{className:"flex flex-col items-center w-full mt-4",children:g.map((e,r)=>(0,t.jsx)("li",{className:"bg-gray-200 text-black p-2 rounded-lg mb-1 w-full text-center dark:bg-gray-700 dark:text-gray-200",children:e.name},r))})]}),(0,t.jsxs)("div",{className:"bg-green-600 text-white p-5 rounded-lg shadow-lg flex-1 min-w-[250px] flex flex-col items-center justify-center text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Real-time Online Count"}),(0,t.jsx)("p",{className:"text-xl",children:y})]}),(0,t.jsxs)("div",{className:"bg-pink-600 text-white p-5 rounded-lg shadow-lg flex-1 min-w-[250px] flex flex-col items-center justify-center text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Average Work Hours Today"}),(0,t.jsxs)("p",{className:"text-xl",children:[f.hours," hours ",f.minutes," mins"]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-5 text-center justify-center",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-lg shadow-lg flex-1 min-w-[250px]",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-gray-300",children:"Weekly Work Hours"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-4 justify-center",children:j.map((e,r)=>(0,t.jsx)("span",{className:"px-4 py-2 rounded-lg cursor-pointer ".concat((null==v?void 0:v.name)===e.name?"bg-green-600 text-white":"bg-gray-200 dark:bg-gray-700"),onClick:()=>S(e),children:e.name},r))}),(0,t.jsx)(h.x1,{data:C,options:{plugins:{legend:{display:!1}}}})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-lg shadow-lg flex-1 min-w-[250px]",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-gray-300",children:"Average Weekly Work Hours"}),(0,t.jsx)(h.$Q,{data:W})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-lg shadow-lg mt-5 w-full",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search by name or position",value:o,onChange:r=>{let a=r.target.value.toLowerCase();d(a),l(e.filter(e=>e.name.toLowerCase().includes(a)||e.title.toLowerCase().includes(a)))},className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg mb-4 dark:bg-gray-900 dark:text-gray-100"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full border-collapse",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"border-b px-4 py-2 text-left bg-gray-100 dark:bg-gray-700 text-sm md:text-base dark:text-gray-300",children:"Name"}),(0,t.jsx)("th",{className:"border-b px-4 py-2 text-left bg-gray-100 dark:bg-gray-700 text-sm md:text-base dark:text-gray-300",children:"Position"}),(0,t.jsx)("th",{className:"border-b px-4 py-2 text-left bg-gray-100 dark:bg-gray-700 text-sm md:text-base dark:text-gray-300",children:"Status"}),(0,t.jsx)("th",{className:"border-b px-4 py-2 text-left bg-gray-100 dark:bg-gray-700 text-sm md:text-base dark:text-gray-300",children:"Last Online"}),(0,t.jsx)("th",{className:"border-b px-4 py-2 text-left bg-gray-100 dark:bg-gray-700 text-sm md:text-base dark:text-gray-300",children:"This Month's Work Hours"})]})}),(0,t.jsx)("tbody",{children:a.map((e,r)=>(0,t.jsxs)("tr",{className:"text-sm md:text-base dark:text-gray-200",children:[(0,t.jsx)("td",{className:"border-b px-4 py-2",children:e.name}),(0,t.jsx)("td",{className:"border-b px-4 py-2",children:e.title}),(0,t.jsx)("td",{className:"border-b px-4 py-2",children:e.status}),(0,t.jsx)("td",{className:"border-b px-4 py-2",children:e.lastOnlineDate}),(0,t.jsxs)("td",{className:"border-b px-4 py-2",children:[(e.thisMonthWorkDuration/60).toFixed(1),"h"]})]},r))})]})})]})]})};a(3537);var p=function(e){let{employee:r,onCancel:a}=e;(0,l.useRouter)();let[o,d]=(0,s.useState)([]),[c,u]=(0,s.useState)({id:"",password:"",name:"",class:"employee",title:"Administrative Officer",gender:"male",email:"",cell:"",address:"",geofence:null,workHours:{Monday:{start:"",end:""},Tuesday:{start:"",end:""},Wednesday:{start:"",end:""},Thursday:{start:"",end:""},Friday:{start:"",end:""},Saturday:{start:"",end:""},Sunday:{start:"",end:""}},lastMonthWorkDuration:{hours:0,minutes:0},lastOnlineDate:"",thisMonthWorkDuration:{hours:0,minutes:0},twoWeeksWorkDuration:{hours:0,minutes:0},workDurationToday:{hours:0,minutes:0},totalWorkDuration:{hours:0,minutes:0}}),[g,m]=(0,s.useState)(""),[x,h]=(0,s.useState)({hours:0,minutes:0}),[y,p]=(0,s.useState)("");(0,s.useEffect)(()=>{if((async()=>{let e=(0,n.IO)((0,n.hJ)(i.Z,"geofence"));d((await (0,n.PL)(e)).docs.map(e=>({id:e.id,...e.data()})))})(),r){let{lastMonthWorkDuration:e,thisMonthWorkDuration:a,twoWeeksWorkDuration:t,workDurationToday:s,totalWorkDuration:l,workHours:o,workPeriod:d,workTime:n,...i}=r;u({...i,workHours:f(o),lastMonthWorkDuration:b(e),thisMonthWorkDuration:b(a),twoWeeksWorkDuration:b(t),workDurationToday:b(s),totalWorkDuration:b(l)}),d&&g&&d[g]&&h(b(d[g])),n&&g&&n[g]?p(n[g]):p("")}},[r,g]);let b=e=>({hours:Math.floor(e/60),minutes:e%60}),k=e=>{let{hours:r,minutes:a}=e;return 60*(parseInt(r)||0)+(parseInt(a)||0)},f=e=>{let r={};return Object.keys(e).forEach(a=>{let[t,s]=e[a].split(" - ").map(e=>"-"===e?"":e);r[a]={start:t,end:s}}),r},w=e=>{let{name:r,value:a}=e.target;if(r.includes(".start")||r.includes(".end")){let[e,t]=r.split(".");u(r=>({...r,workHours:{...r.workHours,[e]:{...r.workHours[e],[t]:a}}}))}else if(r.includes(".hours")||r.includes(".minutes")){let[e,t]=r.split(".");"selectedDateWorkDuration"===e?h(e=>({...e,[t]:a})):u(r=>({...r,[e]:{...r[e],[t]:a}}))}else u(e=>({...e,[r]:a}))},j=async e=>{e.preventDefault();try{let e=(0,n.IO)((0,n.hJ)(i.Z,"employee"),(0,n.ar)("id","==",c.id)),t=await (0,n.PL)(e);if(t.empty){alert("Employee ID does not exist");return}let s=t.docs[0],l=(0,n.JU)(i.Z,"employee",s.id),o={...c,lastMonthWorkDuration:k(c.lastMonthWorkDuration),thisMonthWorkDuration:k(c.thisMonthWorkDuration),twoWeeksWorkDuration:k(c.twoWeeksWorkDuration),workDurationToday:k(c.workDurationToday),totalWorkDuration:k(c.totalWorkDuration),workHours:Object.keys(c.workHours).reduce((e,r)=>(e[r]="".concat(c.workHours[r].start," - ").concat(c.workHours[r].end)||"- -",e),{})};g&&(0!==k(x)&&(o.workPeriod={...r.workPeriod,[g]:k(x)}),y&&(o.workTime={...r.workTime,[g]:y})),await (0,n.r7)(l,o),alert("Employee updated successfully!"),a()}catch(e){console.error("Error updating document: ",e),alert("Error updating employee.")}},N=async()=>{if(confirm("Are you sure you want to delete this employee?"))try{let e=(0,n.IO)((0,n.hJ)(i.Z,"employee"),(0,n.ar)("id","==",c.id)),r=await (0,n.PL)(e);if(r.empty){alert("Employee ID does not exist");return}let t=r.docs[0],s=(0,n.JU)(i.Z,"employee",t.id);await (0,n.oe)(s),alert("Employee deleted successfully!"),a()}catch(e){console.error("Error deleting document: ",e),alert("Error deleting employee.")}};return(0,t.jsxs)("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-gray-900 dark:text-gray-100",children:"Edit Employee"}),(0,t.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"id",className:"font-medium text-gray-900 dark:text-gray-100",children:"ID"}),(0,t.jsx)("input",{type:"text",name:"id",placeholder:"ID",value:c.id,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"password",className:"font-medium text-gray-900 dark:text-gray-100",children:"Password"}),(0,t.jsx)("input",{type:"password",name:"password",placeholder:"Password",value:c.password,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"name",className:"font-medium text-gray-900 dark:text-gray-100",children:"Name"}),(0,t.jsx)("input",{type:"text",name:"name",placeholder:"Name",value:c.name,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"class",className:"font-medium text-gray-900 dark:text-gray-100",children:"Class"}),(0,t.jsxs)("select",{name:"class",value:c.class,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[(0,t.jsx)("option",{value:"employee",children:"Employee"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"title",className:"font-medium text-gray-900 dark:text-gray-100",children:"Title"}),(0,t.jsxs)("select",{name:"title",value:c.title,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[(0,t.jsx)("option",{value:"Administrative Officer",children:"Administrative Officer"}),(0,t.jsx)("option",{value:"Program Coordinator",children:"Program Coordinator"}),(0,t.jsx)("option",{value:"Instructor",children:"Instructor"}),(0,t.jsx)("option",{value:"Receptionist",children:"Receptionist"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"gender",className:"font-medium text-gray-900 dark:text-gray-100",children:"Gender"}),(0,t.jsxs)("select",{name:"gender",value:c.gender,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[(0,t.jsx)("option",{value:"male",children:"Male"}),(0,t.jsx)("option",{value:"female",children:"Female"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"email",className:"font-medium text-gray-900 dark:text-gray-100",children:"Email"}),(0,t.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:c.email,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"cell",className:"font-medium text-gray-900 dark:text-gray-100",children:"Cell"}),(0,t.jsx)("input",{type:"text",name:"cell",placeholder:"Cell",value:c.cell,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"address",className:"font-medium text-gray-900 dark:text-gray-100",children:"Address"}),(0,t.jsx)("input",{type:"text",name:"address",placeholder:"Address",value:c.address,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"geofence",className:"font-medium text-gray-900 dark:text-gray-100",children:"Geofence"}),(0,t.jsxs)("select",{name:"geofence",id:"geofence-select",value:c.geofence,onChange:w,required:!0,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[(0,t.jsx)("option",{value:null,children:"None"}),o.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-gray-100",children:"Work Hours"}),Object.keys(c.workHours).map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("label",{className:"w-16 text-gray-900 dark:text-gray-100",children:e}),(0,t.jsx)("input",{type:"time",name:"".concat(e,".start"),value:c.workHours[e].start,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-24 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-2 text-gray-900 dark:text-gray-100",children:"to"}),(0,t.jsx)("input",{type:"time",name:"".concat(e,".end"),value:c.workHours[e].end,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-24 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]},e))]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"selectedDateWorkDuration.hours",className:"font-medium text-gray-900 dark:text-gray-100",children:"Work Duration for Selected Date"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"date",name:"selectedDate",placeholder:"Selected Date",value:g,onChange:e=>{m(e.target.value),r.workPeriod&&r.workPeriod[e.target.value]?h(b(r.workPeriod[e.target.value])):h({hours:0,minutes:0}),r.workTime&&r.workTime[e.target.value]?p(r.workTime[e.target.value]):p("")},className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("input",{type:"number",name:"selectedDateWorkDuration.hours",placeholder:"Hours",value:x.hours,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"hours"}),(0,t.jsx)("input",{type:"number",name:"selectedDateWorkDuration.minutes",placeholder:"Minutes",value:x.minutes,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"mins"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"selectedDateWorkTime",className:"font-medium text-gray-900 dark:text-gray-100",children:"Start Time - End Time"}),(0,t.jsx)("input",{type:"text",name:"selectedDateWorkTime",placeholder:"Start time & End time",value:y,onChange:e=>{p(e.target.value)},className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"lastOnlineDate",className:"font-medium text-gray-900 dark:text-gray-100",children:"Last Online Date"}),(0,t.jsx)("input",{type:"date",name:"lastOnlineDate",placeholder:"Last Online Date",value:c.lastOnlineDate,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"lastMonthWorkDuration.hours",className:"font-medium text-gray-900 dark:text-gray-100",children:"Last Month Work Duration"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"number",name:"lastMonthWorkDuration.hours",placeholder:"Hours",value:c.lastMonthWorkDuration.hours,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"hours"}),(0,t.jsx)("input",{type:"number",name:"lastMonthWorkDuration.minutes",placeholder:"Minutes",value:c.lastMonthWorkDuration.minutes,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"mins"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"thisMonthWorkDuration.hours",className:"font-medium text-gray-900 dark:text-gray-100",children:"This Month Work Duration"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"number",name:"thisMonthWorkDuration.hours",placeholder:"Hours",value:c.thisMonthWorkDuration.hours,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"hours"}),(0,t.jsx)("input",{type:"number",name:"thisMonthWorkDuration.minutes",placeholder:"Minutes",value:c.thisMonthWorkDuration.minutes,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"mins"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"twoWeeksWorkDuration.hours",className:"font-medium text-gray-900 dark:text-gray-100",children:"Two Weeks Work Duration"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"number",name:"twoWeeksWorkDuration.hours",placeholder:"Hours",value:c.twoWeeksWorkDuration.hours,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"hours"}),(0,t.jsx)("input",{type:"number",name:"twoWeeksWorkDuration.minutes",placeholder:"Minutes",value:c.twoWeeksWorkDuration.minutes,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"mins"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"workDurationToday.hours",className:"font-medium text-gray-900 dark:text-gray-100",children:"Work Duration Today"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"number",name:"workDurationToday.hours",placeholder:"Hours",value:c.workDurationToday.hours,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"hours"}),(0,t.jsx)("input",{type:"number",name:"workDurationToday.minutes",placeholder:"Minutes",value:c.workDurationToday.minutes,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"mins"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{htmlFor:"totalWorkDuration.hours",className:"font-medium text-gray-900 dark:text-gray-100",children:"Total Work Duration"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"number",name:"totalWorkDuration.hours",placeholder:"Hours",value:c.totalWorkDuration.hours,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"hours"}),(0,t.jsx)("input",{type:"number",name:"totalWorkDuration.minutes",placeholder:"Minutes",value:c.totalWorkDuration.minutes,onChange:w,className:"border border-gray-300 dark:border-gray-700 rounded-md p-2 w-20 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"}),(0,t.jsx)("span",{className:"mx-1 text-gray-900 dark:text-gray-100",children:"mins"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)("button",{type:"submit",className:"bg-blue-500 dark:bg-blue-700 text-white dark:text-gray-100 py-2 px-4 rounded-md hover:bg-blue-600 dark:hover:bg-blue-800",children:"Save"}),(0,t.jsx)("button",{type:"button",onClick:a,className:"bg-gray-500 dark:bg-gray-700 text-white dark:text-gray-100 py-2 px-4 rounded-md hover:bg-gray-600 dark:hover:bg-gray-800",children:"Cancel"}),(0,t.jsx)("button",{type:"button",onClick:N,className:"bg-red-500 dark:bg-red-700 text-white dark:text-gray-100 py-2 px-4 rounded-md hover:bg-red-600 dark:hover:bg-red-800",children:"Delete"})]})]})]})},b=()=>{let[e,r]=(0,s.useState)([]);(0,s.useEffect)(()=>{(async()=>{try{let e=(await (0,n.PL)((0,n.hJ)(i.Z,"geofence"))).docs.map(e=>({id:e.id,...e.data()}));r(e)}catch(e){console.error("Error fetching geofences: ",e)}})()},[]);let a=async a=>{try{await (0,n.oe)((0,n.JU)(i.Z,"geofence",a)),r(e.filter(e=>e.id!==a)),alert("Geofence deleted successfully")}catch(e){console.error("Error deleting geofence: ",e),alert("Error deleting geofence")}};return(0,t.jsxs)("div",{className:"p-4 bg-gray-900 text-gray-200",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Geofences"}),e.length>0?(0,t.jsxs)("table",{className:"min-w-full bg-gray-800 border border-gray-700 rounded-lg shadow-md",children:[(0,t.jsx)("thead",{className:"bg-gray-700 border-b border-gray-600",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-gray-300",children:"Name"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-gray-300",children:"Address"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-gray-300"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{className:"border-b border-gray-700 hover:bg-gray-600",children:[(0,t.jsx)("td",{className:"px-6 py-4 text-gray-200",children:e.name}),(0,t.jsx)("td",{className:"px-6 py-4 text-gray-200",children:e.address}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("button",{onClick:()=>a(e.id),className:"bg-red-600 text-white py-1 px-3 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Delete"})})]},e.id))})]}):(0,t.jsx)("p",{className:"text-gray-400",children:"No geofences available"})]})},k=e=>{let{userName:r,updateMessages:a}=e,[l,o]=(0,s.useState)([]),[d,c]=(0,s.useState)(!0),[u,g]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{let e=(await (0,n.PL)((0,n.hJ)(i.Z,"messages"))).docs.map(e=>({id:e.id,...e.data()}));e.sort((e,r)=>r.createdAt.toDate()-e.createdAt.toDate()),o(e),c(!1)})(),g(r)},[r]);let m=async(e,r)=>{let a=(0,n.JU)(i.Z,"messages",e);await (0,n.r7)(a,{status:r}),o(l.map(a=>a.id===e?{...a,status:r}:a))};return(0,t.jsxs)("div",{className:"p-6 bg-gray-50 dark:bg-gray-800 min-h-screen",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100",children:"Employee Messages"}),(0,t.jsx)("ul",{className:"space-y-4",children:l.map(e=>(0,t.jsxs)("li",{className:"p-4 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg shadow-sm",children:[(0,t.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[(0,t.jsx)("strong",{children:"Employee ID:"})," ",e.userId]}),(0,t.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[(0,t.jsx)("strong",{children:"Name:"})," ",e.name]}),(0,t.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[(0,t.jsx)("strong",{children:"Time:"})," ",e.createdAt.toDate().toLocaleString()]}),(0,t.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[(0,t.jsx)("strong",{children:"Message:"})," ",e.message]}),(0,t.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[(0,t.jsx)("strong",{children:"Status:"})," ",e.status]}),"pending"===e.status&&(0,t.jsx)("button",{onClick:()=>{m(e.id,"Resolved by ".concat(u," at ").concat(new Date().toLocaleString())),a()},className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-300",children:"Mark as Resolved"})]},e.id))})]})},f=e=>{let{userId:r,userName:a}=e,[l,o]=(0,s.useState)([]),[d,c]=(0,s.useState)({title:"",message:""}),[u,g]=(0,s.useState)(r),[m,x]=(0,s.useState)(a);(0,s.useEffect)(()=>{(async()=>{try{let e=(await (0,n.PL)((0,n.hJ)(i.Z,"bulletins"))).docs.map(e=>({id:e.id,...e.data()})).sort((e,r)=>{let a=e.createdAt.toDate?e.createdAt.toDate():new Date(e.createdAt);return(r.createdAt.toDate?r.createdAt.toDate():new Date(r.createdAt))-a});o(e)}catch(e){console.error("Error fetching bulletins:",e)}})()},[]);let h=async()=>{try{if(d.title&&d.message){await (0,n.ET)((0,n.hJ)(i.Z,"bulletins"),{title:d.title,author:m,authorId:u,message:d.message,createdAt:new Date}),c({title:"",message:""});let e=(await (0,n.PL)((0,n.hJ)(i.Z,"bulletins"))).docs.map(e=>({id:e.id,...e.data()}));o(e)}}catch(e){console.error("Error adding bulletin:",e)}},y=async e=>{try{await (0,n.oe)((0,n.JU)(i.Z,"bulletins",e));let r=(await (0,n.PL)((0,n.hJ)(i.Z,"bulletins"))).docs.map(e=>({id:e.id,...e.data()}));o(r)}catch(e){console.error("Error deleting bulletin:",e)}};return(0,t.jsxs)("div",{className:"p-6 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Add New Bulletin"}),(0,t.jsx)("input",{type:"text",value:d.title,onChange:e=>c({...d,title:e.target.value}),placeholder:"Title",className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg mb-4 text-gray-800 dark:text-gray-200 bg-gray-200 dark:bg-gray-700 placeholder-gray-500 dark:placeholder-gray-400"}),(0,t.jsx)("textarea",{value:d.message,onChange:e=>c({...d,message:e.target.value}),placeholder:"Message",className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-800 dark:text-gray-200 bg-gray-200 dark:bg-gray-700 placeholder-gray-500 dark:placeholder-gray-400",rows:"4"}),(0,t.jsx)("button",{onClick:()=>h(d),disabled:!d.title||!d.message,className:"mt-4 py-2 px-4 w-full rounded-lg font-medium text-white ".concat(d.title&&d.message?"bg-blue-500 dark:bg-blue-600 hover:bg-blue-600 dark:hover:bg-blue-700":"bg-gray-400 dark:bg-gray-600 cursor-not-allowed"," transition-colors"),children:"Add Bulletin"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Bulletin List"}),(0,t.jsx)("ul",{className:"space-y-4",children:l.map(e=>(0,t.jsxs)("li",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e.title}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["By: ",e.author]})]}),(0,t.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:new Date(e.createdAt.toDate()).toLocaleString()}),r===e.authorId&&(0,t.jsx)("button",{className:"mt-2 py-1 px-3 text-sm font-medium text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300",onClick:()=>y(e.id),children:"Delete"})]},e.id))})]})]})},w=a(4573),j=a(4589),N=e=>{let{adminName:r,selectedPage:a,setSelectedPage:l,handleLogout:o,handlePendingMessages:d}=e,[n,i]=(0,s.useState)(!1),c=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&i(!1)};return n?document.addEventListener("mousedown",e):document.removeEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[n]);let u=e=>{l(e),"Messages"===e&&d(!1)};return(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{className:"md:hidden p-4 absolute top-4 left-4 text-white",onClick:()=>i(!n),"aria-label":"Toggle sidebar",children:n?(0,t.jsx)(w.Z,{className:"w-6 h-6"}):(0,t.jsx)(j.Z,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{ref:c,className:"fixed inset-y-0 left-0 w-64 bg-primaryDark text-white p-6 flex flex-col justify-between md:relative md:w-64 md:flex md:flex-col md:justify-between transition-transform duration-300 transform ".concat(n?"translate-x-0":"-translate-x-full"," md:translate-x-0 overflow-y-auto md:overflow-y-auto"),"aria-label":"Sidebar",children:[(0,t.jsxs)("div",{className:"flex flex-col flex-grow",children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold",children:"Welcome,"}),(0,t.jsx)("h2",{className:"text-2xl font-bold",children:r})]}),(0,t.jsx)("div",{className:"flex flex-col flex-grow space-y-2",children:["Dashboard","Employee List","Register","Bulletin","Messages","GeofenceDisplay","GeofenceSetup"].map(e=>(0,t.jsx)("button",{className:"text-left py-2 px-4 rounded transition-colors focus:outline-none ".concat(a===e?"bg-accent text-white":"bg-primaryDark text-gray-200 hover:bg-accent focus:bg-accent"),onClick:()=>{u(e),i(!1)},"aria-label":"Go to ".concat(e),children:e},e))})]}),(0,t.jsx)("div",{className:"text-center mt-4",children:(0,t.jsx)("button",{className:"w-full py-2 px-4 bg-red-600 hover:bg-red-700 rounded text-white focus:outline-none",onClick:()=>{o(),i(!1)},"aria-label":"Logout",children:"Logout"})})]})]})};let v=(0,d.default)(()=>Promise.all([a.e(529),a.e(415),a.e(522),a.e(747),a.e(681)]).then(a.bind(a,7681)),{loadableGenerated:{webpack:()=>[7681]},ssr:!1});var D=(0,o.Z)(function(){let[e,r]=(0,s.useState)("Dashboard"),[a,o]=(0,s.useState)(""),[d,u]=(0,s.useState)(""),[g,m]=(0,s.useState)(null),[h,w]=(0,s.useState)(!1),[j,D]=(0,s.useState)(!1),_=(0,l.useRouter)();(0,s.useEffect)(()=>{let e=localStorage.getItem("userId");e&&u(e);let r=localStorage.getItem("adminName");r&&o(r),C()},[]);let C=async()=>{let e=(0,n.IO)((0,n.hJ)(i.Z,"messages"),(0,n.ar)("status","==","pending"));w(!(await (0,n.PL)(e)).empty)};return(0,t.jsxs)("div",{className:"flex h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[(0,t.jsx)("title",{children:"MTG - Admin"}),(0,t.jsx)(N,{adminName:a,selectedPage:e,setSelectedPage:r,isSidebarOpen:j,setIsSidebarOpen:D,handleLogout:()=>{localStorage.removeItem("adminName"),_.push("/")},handlePendingMessages:w}),(0,t.jsx)("div",{className:"flex-grow transition-all duration-300 ease-in-out ".concat(j?"ml-64":"ml-16"," p-6 bg-gray-100 dark:bg-gray-900 flex flex-col max-w-full overflow-hidden"),children:(0,t.jsx)("div",{className:"flex-1 overflow-y-auto max-w-full",children:(()=>{switch(e){case"Dashboard":default:return(0,t.jsx)(y,{});case"Employee List":return(0,t.jsx)(x,{onEdit:e=>{m(e),r("Edit")}});case"Register":return(0,t.jsx)(c,{});case"Edit":return(0,t.jsx)(p,{employee:g,onCancel:()=>r("Employee List")});case"Bulletin":return(0,t.jsx)(f,{userId:d,userName:a});case"Messages":return(0,t.jsx)(k,{userName:a,updateMessages:C});case"GeofenceDisplay":return(0,t.jsx)(b,{});case"GeofenceSetup":return(0,t.jsx)(v,{})}})()})})]})})},5344:function(e,r,a){"use strict";var t=a(5236),s=a(9842),l=a(9854);let o=(0,t.ZF)({apiKey:"AIzaSyB5__zMeXEsk4RxME0Fg46Sz7AhqZzA9qE",authDomain:"mtg-quickyclock.firebaseapp.com",projectId:"mtg-quickyclock",storageBucket:"mtg-quickyclock.appspot.com",messagingSenderId:"865821745601",appId:"1:865821745601:web:b01221defd23ac3d338f40"}),d=(0,s.ad)(o);(0,l.cF)(o),r.Z=d},8370:function(e,r,a){"use strict";var t=a(7437),s=a(6463),l=a(2265);r.Z=e=>{let r=r=>{let a=(0,s.useRouter)();return(0,l.useEffect)(()=>{{let e=localStorage.getItem("userName"),r=localStorage.getItem("adminName");e||r||a.push("/")}},[a]),(0,t.jsx)(e,{...r})};return r.displayName="withAuth(".concat(e.displayName||e.name||"Component",")"),r}},3537:function(e){e.exports={container:"admin_container__T9cg4",sidebar:"admin_sidebar__5knmB",welcome:"admin_welcome__EOlff",menu:"admin_menu__Y1Ly4",sidebarItem:"admin_sidebarItem__qvaqy",blinking:"admin_blinking___Tdke",blink:"admin_blink__pEves",logout:"admin_logout__AnB4w",main:"admin_main__zshRw",dashboard:"admin_dashboard__a0Ls_",card:"admin_card__Kn9tF",content:"admin_content__Nu_se",register:"admin_register__xR5KE",input:"admin_input__O8BkZ",formGroup:"admin_formGroup__rBUwz",workHours:"admin_workHours__UhxOF",workHoursRow:"admin_workHoursRow__s7mQ3",inputTime:"admin_inputTime__Soann",buttonGroup:"admin_buttonGroup__P8OAf",saveButton:"admin_saveButton__aSLLv",cancelButton:"admin_cancelButton__rtWWq",button:"admin_button__MLcPe",durationFields:"admin_durationFields__DWQXe",searchBar:"admin_searchBar__iAS0a",exportButton:"admin_exportButton__RN1ka",employeeList:"admin_employeeList__O9YWH",employeeCard:"admin_employeeCard___xEpz",header:"admin_header__zGWj8",editTitle:"admin_editTitle__smNi5",span:"admin_span__8M3CT",inputWorkHours:"admin_inputWorkHours__NwpD9",tableContainer:"admin_tableContainer__XkWgJ",workTable:"admin_workTable__ph5H8","map-container":"admin_map-container__Naoh6"}}},function(e){e.O(0,[351,358,425,674,900,790,971,23,744],function(){return e(e.s=8588)}),_N_E=e.O()}]);