(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9169:function(e,o,t){Promise.resolve().then(t.bind(t,9320))},3299:function(e,o,t){"use strict";t.d(o,{el:function(){return m},hq:function(){return u},pM:function(){return g},x$:function(){return d}});var a=t(9842),n=t(9450),r=t(5344);let i=null,s=(e,o)=>{i&&clearInterval(i),i=setInterval(async()=>{await d(e,o)},6e4)},l=e=>{let o=n.ou.now().setZone("America/Edmonton").minus({months:1}).month,t=0;for(let a in e)n.ou.fromISO(a).setZone("America/Edmonton").month===o&&(t+=e[a]);return t},A=e=>{let o=n.ou.now().setZone("America/Edmonton"),t=o.month,a=o.year,r=0;if(o.day<=15){let o=n.ou.local(a,t,1).setZone("America/Edmonton"),i=n.ou.local(a,t,15).setZone("America/Edmonton");for(let t in e){let a=n.ou.fromISO(t).setZone("America/Edmonton");a>=o&&a<=i&&(r+=e[t])}}else{let i=n.ou.local(a,t,16).setZone("America/Edmonton"),s=n.ou.local(a,t,o.daysInMonth).setZone("America/Edmonton");for(let o in e){let t=n.ou.fromISO(o).setZone("America/Edmonton");t>=i&&t<=s&&(r+=e[o])}}return r},c=e=>{let o=n.ou.now().setZone("America/Edmonton").month,t=0;for(let a in e)n.ou.fromISO(a).setZone("America/Edmonton").month===o&&(t+=e[a]);return t},d=async(e,o)=>{let t=(0,a.IO)((0,a.hJ)(r.Z,"employee"),(0,a.ar)("id","==",e)),s=await (0,a.PL)(t);if(!s.empty){let e=s.docs[0],t=(0,a.JU)(r.Z,"employee",e.id),d=e.data();if("online"===d.status){let e=n.ou.now().setZone("America/Edmonton"),r=e.toISODate(),i=d.workTime[r],s=n.ou.fromISO(i.split(" - ")[0]),m=Math.round(e.diff(s,"minutes").minutes-(d.totalBreakDuration||0));o(m);let u={...d.workPeriod,[r]:m},g=(d.totalWorkDuration||0)+m,p=c(u),I=A(u),f=l(u);await (0,a.r7)(t,{workDurationToday:m,totalWorkDuration:g,twoWeeksWorkDuration:I,thisMonthWorkDuration:p,lastMonthWorkDuration:f,workPeriod:u}),console.log("Work duration updated successfully.")}else clearInterval(i)}},m=async(e,o,t,i,l)=>{let A=(0,a.IO)((0,a.hJ)(r.Z,"employee"),(0,a.ar)("id","==",e));try{let c=await (0,a.PL)(A);if(c.empty)console.log("User document does not exist for ID: ".concat(e));else{let A=c.docs[0],d=(0,a.JU)(r.Z,"employee",A.id),m=A.data(),u=n.ou.now().setZone("America/Edmonton"),g=u.weekdayLong,p=m.workHours[g];if(" - "===p){alert("Today is a day off, you cannot clock in.");return}let[I,f]=p.split(" - "),E=n.ou.fromISO(I,{zone:"America/Edmonton"}).minus({minutes:30}),w=n.ou.fromISO(f,{zone:"America/Edmonton"}).plus({minutes:30});if(u<E||u>w){alert("It is not within the allowed clock-in time range.");return}t(!0),o(u),i("Clocked In at ".concat(u.toLocaleString(n.ou.DATETIME_FULL_WITH_SECONDS)));let y=u.toISODate(),h={...m.workTime,[y]:u.toFormat("HH:mm")};await (0,a.r7)(d,{status:"online",workDurationToday:0,workTime:h,totalBreakDuration:0,isOnBreak:!1}),console.log("User status set to online and workDurationToday initialized."),s(e,l)}}catch(e){console.error("Error clocking in:",e)}},u=async(e,o,t,i)=>{o(!1);let s=n.ou.now().setZone("America/Edmonton");t("Clocked Out at ".concat(s.toLocaleString(n.ou.DATETIME_FULL_WITH_SECONDS)));let l=(0,a.IO)((0,a.hJ)(r.Z,"employee"),(0,a.ar)("id","==",e));try{let o=await (0,a.PL)(l);if(o.empty)console.log("User document does not exist for ID: ".concat(e));else{let e=o.docs[0],t=(0,a.JU)(r.Z,"employee",e.id),l=e.data(),A=s.toISODate(),c=l.workTime[A],d=n.ou.fromISO("".concat(A,"T").concat(c),{zone:"America/Edmonton"}),m=Math.round(s.diff(d,"minutes").minutes-(l.totalBreakDuration||0)),u={...l.workPeriod,[A]:m},g={...l.workTime,[A]:"".concat(c," - ").concat(s.toFormat("HH:mm"))};await (0,a.r7)(t,{status:"offline",isOnBreak:!1,workDurationToday:m,workPeriod:u,workTime:g}),console.log("User status set to offline and work duration updated."),i(m)}}catch(e){console.error("Error clocking out:",e)}},g=async(e,o,t,i,s)=>{o(!0),s("Break started at ".concat(n.ou.now().setZone("America/Edmonton").toLocaleString(n.ou.DATETIME_FULL_WITH_SECONDS)));let l=(0,a.IO)((0,a.hJ)(r.Z,"employee"),(0,a.ar)("id","==",e)),A=await (0,a.PL)(l);if(!A.empty){let e=A.docs[0],l=(0,a.JU)(r.Z,"employee",e.id);await (0,a.r7)(l,{isOnBreak:!0}),t(setTimeout(async()=>{o(!1),s("Break ended at ".concat(n.ou.now().setZone("America/Edmonton").toLocaleString(n.ou.DATETIME_FULL_WITH_SECONDS))),await (0,a.r7)(l,{isOnBreak:!1}),t(null)},6e4*i))}}},5344:function(e,o,t){"use strict";var a=t(5236),n=t(9842),r=t(9854);let i=(0,a.ZF)({apiKey:"AIzaSyB5__zMeXEsk4RxME0Fg46Sz7AhqZzA9qE",authDomain:"mtg-quickyclock.firebaseapp.com",projectId:"mtg-quickyclock",storageBucket:"mtg-quickyclock.appspot.com",messagingSenderId:"865821745601",appId:"1:865821745601:web:b01221defd23ac3d338f40"}),s=(0,n.ad)(i);(0,r.cF)(i),o.Z=s},9320:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return g}});var a=t(7437),n=t(6463),r=t(2265),i=t(6648),s=t(8518),l=t.n(s),A=t(9842),c=t(5344),d=t(9450),m={src:"/_next/static/media/MTGBCSLogo.3420c02d.jpg",height:960,width:2304,blurDataURL:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAMACAMBIgACEQEDEQH/xAAoAAEBAAAAAAAAAAAAAAAAAAAABwEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAK4I/8QAGRABAAIDAAAAAAAAAAAAAAAAAQMRAAIh/9oACAEBAAE/AIYtCWgoVXuf/8QAFREBAQAAAAAAAAAAAAAAAAAAAQD/2gAIAQIBAT8AFb//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDAQE/AH//2Q==",blurWidth:8,blurHeight:3},u=t(3299);function g(){let e=(0,n.useRouter)(),o=async()=>{let e=d.ou.now().setZone("America/Edmonton").toISODate();(await (0,A.PL)((0,A.hJ)(c.Z,"employee"))).forEach(async o=>{let t=o.data().lastOnlineDate||e;if(e!==t){let e=(0,A.JU)(c.Z,"employee",o.id);await (0,A.r7)(e,{workDurationToday:0})}})};(0,r.useEffect)(()=>{o()},[]);let t=async()=>{let o=document.getElementById("mtgId").value,t=document.getElementById("password").value,a=(0,A.IO)((0,A.hJ)(c.Z,"employee"),(0,A.ar)("id","==",o),(0,A.ar)("password","==",t)),n=await (0,A.PL)(a);if(n.empty)console.error("Invalid credentials"),alert("Invalid credentials");else{let t=n.docs[0].data();localStorage.setItem("userName",t.name),localStorage.setItem("userId",o),(0,u.x$)(o),e.push("/employee")}},s=async()=>{let o=document.getElementById("mtgId").value,t=document.getElementById("password").value,a=(0,A.IO)((0,A.hJ)(c.Z,"employee"),(0,A.ar)("id","==",o),(0,A.ar)("password","==",t)),n=await (0,A.PL)(a);if(n.empty)console.error("Invalid credentials"),alert("Invalid credentials");else{let t=n.docs[0].data();"admin"===t.class?(localStorage.setItem("adminName",t.name),localStorage.setItem("userId",o),(0,u.x$)(o),e.push("/admin")):(console.error("You are not authorized to access admin page"),alert("You are not authorized to access admin page"))}};return(0,a.jsxs)("div",{className:l().container,children:[(0,a.jsx)("title",{children:"MTG"}),(0,a.jsxs)("div",{className:l().formContainer,children:[(0,a.jsx)(i.default,{src:m,alt:"MTG Logo",className:l().logo,width:250,height:110}),(0,a.jsx)("input",{type:"text",placeholder:"Enter Your MTG ID",className:l().input,id:"mtgId"}),(0,a.jsx)("input",{type:"password",placeholder:"Password",className:l().input,id:"password"}),(0,a.jsx)("button",{className:l().button,onClick:t,children:"Login"}),(0,a.jsx)("a",{onClick:s,className:l().forgetPassword,children:"Login as Admin"})]}),(0,a.jsx)("div",{className:l().copyright,children:"\xa9 2024 MTG Healthcare Academy"})]})}},8518:function(e){e.exports={container:"page_container__jZF7q",logo:"page_logo__ikIZE",title:"page_title__po7na",formContainer:"page_formContainer__9vwPo",input:"page_input__lx_gt",button:"page_button__52WaL",forgetPassword:"page_forgetPassword__zMizj",copyright:"page_copyright__FJcf5"}}},function(e){e.O(0,[851,358,900,648,971,23,744],function(){return e(e.s=9169)}),_N_E=e.O()}]);