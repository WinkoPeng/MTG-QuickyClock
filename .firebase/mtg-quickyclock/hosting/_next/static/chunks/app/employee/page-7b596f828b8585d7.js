(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[487],{9870:function(e,t,o){Promise.resolve().then(o.bind(o,7417))},7417:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return y}});var n=o(7437),a=o(6463),l=o(2265),r=o(9450),s=o(4769),c=o.n(s),u=o(8370),i=o(9842),d=o(5344);let m=async(e,t,o)=>{confirm("Are you sure you want to logout?")&&(e&&await t(),o.push("/"))},_=null,p=async e=>{let t=(0,i.IO)((0,i.hJ)(d.Z,"employee"),(0,i.ar)("id","==",e)),o=await (0,i.PL)(t);if(!o.empty){let e=o.docs[0],t=(0,i.JU)(d.Z,"employee",e.id),n=e.data(),a=r.ou.now().setZone("America/Edmonton"),l=a.toISODate(),s=n.lastOnlineDate||l,c=n.workDurationToday||0;l!==s&&(c=0),c+=1;let u=(n.totalWorkDuration||0)+1,m=(n.twoWeeksWorkDuration||0)+1,_=(n.thisMonthWorkDuration||0)+1,p=a.month,k=r.ou.fromISO(s).month,h=n.lastMonthWorkDuration||0;p!==k&&(h=_),await (0,i.r7)(t,{workDurationToday:c,totalWorkDuration:u,twoWeeksWorkDuration:m,thisMonthWorkDuration:_,lastMonthWorkDuration:h,lastOnlineDate:l}),console.log("Work duration updated successfully.")}},k=async(e,t,o,n)=>{let a=(0,i.IO)((0,i.hJ)(d.Z,"employee"),(0,i.ar)("id","==",e));try{let l=await (0,i.PL)(a);if(l.empty)console.log("User document does not exist for ID: ".concat(e));else{let a=l.docs[0],s=(0,i.JU)(d.Z,"employee",a.id),c=a.data(),u=r.ou.now().setZone("America/Edmonton"),m=u.weekdayLong,k=c.workHours[m];if(" - "===k){alert("You cannot clock in today as it's your day off.");return}o(!0),t(u),n("Clocked In at ".concat(u.toLocaleString(r.ou.DATETIME_FULL_WITH_SECONDS))),await (0,i.r7)(s,{status:"online",workDurationToday:c.workDurationToday||0}),console.log("User status set to online and workDurationToday initialized."),_=setInterval(()=>{p(e)},6e4)}}catch(e){console.error("Error clocking in:",e)}},h=async(e,t,o,n,a,l,s,c,u)=>{clearInterval(_),t(!1);let m=r.ou.now().setZone("America/Edmonton");if(s){clearTimeout(c),n("Break ended at ".concat(m.toLocaleString(r.ou.DATETIME_FULL_WITH_SECONDS)));let e=a.plus({minutes:l}),t=m.diff(e,"minutes").minutes;o(e=>e+t),u(!1)}let p=m.diff(a,"minutes").minutes-l,k=Math.floor(p/60),h=p%60;(k<0||0===k&&h<0)&&(k=0,h=0),n("Clocked Out at ".concat(m.toLocaleString(r.ou.DATETIME_FULL_WITH_SECONDS))),n("Duration: ".concat(k," hours ").concat(h," minutes, from ").concat(a.toLocaleString(r.ou.DATETIME_FULL_WITH_SECONDS)," to ").concat(m.toLocaleString(r.ou.DATETIME_FULL_WITH_SECONDS)));let y=(0,i.IO)((0,i.hJ)(d.Z,"employee"),(0,i.ar)("id","==",e));try{let t=await (0,i.PL)(y);if(t.empty)console.log("User document does not exist for ID: ".concat(e));else{let e=t.docs[0],o=(0,i.JU)(d.Z,"employee",e.id);await (0,i.r7)(o,{status:"offline"}),console.log("User status set to offline.")}}catch(e){console.error("Error clocking out:",e)}o(0)};var y=(0,u.Z)(()=>{let e=(0,a.useRouter)(),[t,o]=(0,l.useState)(r.ou.now().setZone("America/Edmonton").toLocaleString(r.ou.DATETIME_FULL_WITH_SECONDS)),[s,u]=(0,l.useState)(""),[i,d]=(0,l.useState)(""),[_,p]=(0,l.useState)(""),[y,b]=(0,l.useState)(""),[g,f]=(0,l.useState)("select"),[S,I]=(0,l.useState)([]),[E,T]=(0,l.useState)(null),[w,x]=(0,l.useState)(!1),[v,j]=(0,l.useState)(!1),[D,L]=(0,l.useState)(null),[N,B]=(0,l.useState)(0),[O,C]=(0,l.useState)("");(0,l.useEffect)(()=>{let e=localStorage.getItem("userName"),t=localStorage.getItem("userId");e&&u(e),t&&d(t);let n=setInterval(()=>{let e=r.ou.now().setZone("America/Edmonton");o(e.toLocaleString(r.ou.DATETIME_FULL_WITH_SECONDS));let t=e.hour;t<12?C("Good morning"):t<18?C("Good afternoon"):C("Good evening")},1e3);return()=>clearInterval(n)},[]);let A=(0,l.useCallback)(e=>{I(o=>[...o,{time:t,message:e}])},[t]),M=e=>{f(e.target.value),"select"===e.target.value?b(""):p("")};return(0,l.useEffect)(()=>{let e=async e=>{w&&(e.preventDefault(),e.returnValue="Are you sure you want to close the window? You will be clocked out.",confirm("Are you sure you want to close the window? You will be clocked out.")&&await h(i,x,B,A,D,N,v,E,j))};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[w,i,D,N,v,E,A]),(0,n.jsx)("div",{className:c().container,children:(0,n.jsxs)("div",{className:c().formContainer,children:[(0,n.jsxs)("h1",{children:[O,", ",s,"!"]}),(0,n.jsxs)("div",{className:c().currentTime,children:["Current Time: ",t]}),(0,n.jsxs)("div",{className:c().buttonAndBreakGroup,children:[(0,n.jsxs)("div",{className:c().buttonGroup,children:[(0,n.jsx)("button",{className:"".concat(c().clockInButton," ").concat(w?c().disabledButton:""),onClick:()=>k(i,L,x,A),disabled:w,children:"Clock In"}),(0,n.jsx)("button",{className:"".concat(c().clockOutButton," ").concat(w?"":c().disabledButton),onClick:()=>h(i,x,B,A,D,N,v,E,j),disabled:!w,children:"Clock Out"})]}),(0,n.jsxs)("div",{className:c().breakGroup,children:[(0,n.jsxs)("div",{className:c().breakOption,children:[(0,n.jsx)("input",{type:"radio",name:"breakOption",value:"select",checked:"select"===g,onChange:M,disabled:!w}),(0,n.jsxs)("select",{className:c().breakSelect,value:_,onChange:e=>{p(e.target.value),f("select")},disabled:"select"!==g||!w,children:[(0,n.jsx)("option",{value:"15",children:"15 min"}),(0,n.jsx)("option",{value:"30",children:"30 min"}),(0,n.jsx)("option",{value:"45",children:"45 min"}),(0,n.jsx)("option",{value:"60",children:"60 min"})]})]}),(0,n.jsxs)("div",{className:c().breakOption,children:[(0,n.jsx)("input",{type:"radio",name:"breakOption",value:"custom",checked:"custom"===g,onChange:M,disabled:!w}),(0,n.jsx)("input",{type:"number",className:c().breakInput,placeholder:"Custom",value:y,onChange:e=>{b(e.target.value),f("custom")},disabled:"custom"!==g||!w,min:"1"})]}),(0,n.jsx)("button",{className:"".concat(c().startBreakButton," ").concat(!w||v?c().disabledButton:""),onClick:()=>{let e="select"===g?_:y;if(""===e||0===parseInt(e)){alert("Break duration must be greater than 0 and not empty.");return}j(!0),A("Break started at ".concat(t)),T(setTimeout(()=>{A("Break ended at ".concat(r.ou.now().setZone("America/Edmonton").toLocaleString(r.ou.DATETIME_FULL_WITH_SECONDS))),alert("Break ended"),j(!1),B(t=>t+e/6e4),T(null)},e=6e4*parseInt(e)))},disabled:!w||v,children:"Start Break"})]})]}),(0,n.jsx)("div",{className:c().log,children:(0,n.jsxs)("table",{className:c().logTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Time"}),(0,n.jsx)("th",{children:"Message"})]})}),(0,n.jsx)("tbody",{children:S.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.time}),(0,n.jsx)("td",{children:e.message})]},t))})]})}),(0,n.jsx)("button",{className:c().logoutButton,onClick:()=>m(w,()=>h(i,x,B,A,D,N,v,E,j),e),children:"Log Out"})]})})})},5344:function(e,t,o){"use strict";var n=o(5236),a=o(9842),l=o(9854);let r=(0,n.ZF)({apiKey:"AIzaSyB5__zMeXEsk4RxME0Fg46Sz7AhqZzA9qE",authDomain:"mtg-quickyclock.firebaseapp.com",projectId:"mtg-quickyclock",storageBucket:"mtg-quickyclock.appspot.com",messagingSenderId:"865821745601",appId:"1:865821745601:web:b01221defd23ac3d338f40"}),s=(0,a.ad)(r);(0,l.cF)(r),t.Z=s},8370:function(e,t,o){"use strict";var n=o(7437),a=o(6463),l=o(2265);t.Z=e=>{let t=t=>{let o=(0,a.useRouter)();return(0,l.useEffect)(()=>{{let e=localStorage.getItem("userName"),t=localStorage.getItem("adminName");e||t||o.push("/")}},[o]),(0,n.jsx)(e,{...t})};return t.displayName="withAuth(".concat(e.displayName||e.name||"Component",")"),t}},4769:function(e){e.exports={container:"employee_container__38_MF",formContainer:"employee_formContainer__b8qtM",currentTime:"employee_currentTime__fa65a",buttonAndBreakGroup:"employee_buttonAndBreakGroup__nsAjr",buttonGroup:"employee_buttonGroup__hBnnY",clockInButton:"employee_clockInButton__zL5RK",clockOutButton:"employee_clockOutButton___OENO",startBreakButton:"employee_startBreakButton__KRkim",button:"employee_button__RdhaT",disabledButton:"employee_disabledButton__h46X_",breakGroup:"employee_breakGroup__6AevP",breakOption:"employee_breakOption__f249u",breakSelect:"employee_breakSelect__yDLJJ",breakInput:"employee_breakInput__uUJRy",log:"employee_log__9iUMH",logTable:"employee_logTable__oFT7h",logoutButton:"employee_logoutButton__CdvJg",currentTimeText:"employee_currentTimeText__hDI66"}}},function(e){e.O(0,[432,358,900,971,23,744],function(){return e(e.s=9870)}),_N_E=e.O()}]);