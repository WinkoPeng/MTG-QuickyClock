(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[487],{4654:function(){},6611:function(e,t,a){Promise.resolve().then(a.bind(a,4385))},4385:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var r=a(7437),s=a(6463),o=a(2265),l=a(9450),n=a(9842),d=a(5344);let i=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];var c=e=>{let{employeeId:t}=e,[a,s]=(0,o.useState)({}),[l,c]=(0,o.useState)(!0);(0,o.useEffect)(()=>{(async()=>{try{let e=(0,n.IO)((0,n.hJ)(d.Z,"employee"),(0,n.ar)("id","==",t)),a=await (0,n.PL)(e);if(!a.empty){let e=a.docs[0].data();console.log(e),s(e.workHours)}}catch(e){setError("Error fetching work hours: "+e.message)}finally{c(!1)}})()},[t]);let u=Object.entries(a).sort((e,t)=>i.indexOf(e[0])-i.indexOf(t[0]));return(0,r.jsxs)("div",{className:"p-6 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-6",children:"Your Weekly Work Hours"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-md",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100 dark:bg-gray-700 text-left text-gray-600 dark:text-gray-300",children:[(0,r.jsx)("th",{className:"px-6 py-3 border-b border-gray-200 dark:border-gray-600",children:"Day"}),(0,r.jsx)("th",{className:"px-6 py-3 border-b border-gray-200 dark:border-gray-600",children:"Hours"})]})}),(0,r.jsx)("tbody",{children:u.map(e=>{let[t,a]=e;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,r.jsx)("td",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-600 text-gray-800 dark:text-gray-100",children:t}),(0,r.jsx)("td",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-600 text-gray-800 dark:text-gray-100",children:a})]},t)})})]})})]})},u=a(8370),m=e=>{let{userId:t,showPasswordModal:a,setShowPasswordModal:s}=e,[l,i]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[m,g]=(0,o.useState)(""),x=async e=>{if(e.preventDefault(),c!==m){alert("New password and confirm new password do not match.");return}try{let e=(0,n.IO)((0,n.hJ)(d.Z,"employee"),(0,n.ar)("id","==",t)),a=await (0,n.PL)(e);if(a.empty){alert("Employee ID does not exist");return}let r=a.docs[0];if(r.data().password!==l){alert("Current password is incorrect.");return}let o=(0,n.JU)(d.Z,"employee",r.id);await (0,n.r7)(o,{password:c}),alert("Password changed successfully!"),s(!1)}catch(e){console.error("Error updating password: ",e),alert("Error updating password.")}};return a?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-full max-w-md relative",children:[(0,r.jsx)("button",{className:"absolute top-2 right-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100",onClick:()=>s(!1),"aria-label":"Close",children:"\xd7"}),(0,r.jsxs)("form",{onSubmit:x,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300",children:"Current Password:"}),(0,r.jsx)("input",{type:"password",className:"mt-1 p-2 w-full border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-gray-100 bg-gray-50 dark:bg-gray-700 focus:border-blue-500 focus:ring-blue-500",value:l,onChange:e=>i(e.target.value)})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300",children:"New Password:"}),(0,r.jsx)("input",{type:"password",className:"mt-1 p-2 w-full border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-gray-100 bg-gray-50 dark:bg-gray-700 focus:border-blue-500 focus:ring-blue-500",value:c,onChange:e=>u(e.target.value)})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300",children:"Confirm New Password:"}),(0,r.jsx)("input",{type:"password",className:"mt-1 p-2 w-full border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-gray-100 bg-gray-50 dark:bg-gray-700 focus:border-blue-500 focus:ring-blue-500",value:m,onChange:e=>g(e.target.value)})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)("button",{type:"submit",className:"py-2 px-4 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500",children:"Confirm"}),(0,r.jsx)("button",{type:"button",className:"py-2 px-4 bg-gray-500 text-white rounded-lg font-medium hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500",onClick:()=>s(!1),children:"Cancel"})]})]})]})}):null},g=()=>{let[e,t]=(0,o.useState)([]),[a,s]=(0,o.useState)(!1),[l,i]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(async()=>{try{let e=(await (0,n.PL)((0,n.hJ)(d.Z,"bulletins"))).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{let a=e.createdAt.toDate?e.createdAt.toDate():new Date(e.createdAt);return(t.createdAt.toDate?t.createdAt.toDate():new Date(t.createdAt))-a});t(e)}catch(e){console.error("Error fetching bulletins:",e)}})()},[]);let c=e.length>0?e[0]:null;return(0,r.jsxs)("div",{className:"relative rounded-lg p-4 bg-gray-100 dark:bg-gray-900",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100",children:"Bulletin Board"}),c&&!a?(0,r.jsxs)("div",{className:"p-3 bg-white dark:bg-gray-800 shadow-md rounded-lg mb-4",children:[(0,r.jsxs)("div",{className:"mb-1",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:c.title}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["By: ",c.author]})]}),(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-1 ".concat(l?"":"line-clamp-3"),children:c.message}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:new Date(c.createdAt.toDate()).toLocaleString()}),c.message.length>200&&(0,r.jsx)("button",{onClick:()=>i(!l),className:"mt-2 px-3 py-1 bg-blue-600 dark:bg-blue-700 text-white rounded hover:bg-blue-700 dark:hover:bg-blue-600 text-sm",children:l?"Show Less":"Read More"}),(0,r.jsx)("button",{onClick:()=>s(!0),className:"mt-2 ml-2 px-3 py-1 bg-blue-600 dark:bg-blue-700 text-white rounded hover:bg-blue-700 dark:hover:bg-blue-600 text-sm",children:"Show All Messages"})]}):null,a&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg w-full max-w-lg max-h-[80vh] overflow-y-auto relative",children:[(0,r.jsx)("button",{onClick:()=>s(!1),className:"absolute top-2 right-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100","aria-label":"Close",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-gray-100",children:"All Bulletins"}),(0,r.jsx)("ul",{className:"space-y-2",children:e.map(e=>(0,r.jsxs)("li",{className:"p-2 bg-gray-50 dark:bg-gray-700 shadow-md rounded-lg",children:[(0,r.jsxs)("div",{className:"mb-1",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:e.title}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["By: ",e.author]})]}),(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-1",children:e.message}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:new Date(e.createdAt.toDate()).toLocaleString()})]},e.id))})]})})]})},x=e=>{let{userId:t,showSentFormsModal:a,setSentFormsModal:s}=e,[l,i]=(0,o.useState)([]),[c,u]=(0,o.useState)(!0),[m,g]=(0,o.useState)(null);return((0,o.useEffect)(()=>{(async()=>{u(!0);try{let e=(0,n.hJ)(d.Z,"messages"),a=(0,n.IO)(e,(0,n.ar)("userId","==",t)),r=(await (0,n.PL)(a)).docs.map(e=>({id:e.id,...e.data()}));i(r)}catch(e){g("Error fetching messages"),console.error(e)}finally{u(!1)}})()},[t]),c)?(0,r.jsx)("p",{children:"Loading..."}):m?(0,r.jsx)("p",{children:m}):(0,r.jsx)(r.Fragment,{children:a&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-full max-w-lg relative",children:[(0,r.jsx)("button",{className:"absolute top-2 right-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100",onClick:()=>s(!1),"aria-label":"Close",children:"\xd7"}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"My Sent Forms"}),0===l.length?(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No sent forms found."}):(0,r.jsx)("ul",{className:"space-y-4",children:l.map(e=>(0,r.jsxs)("li",{className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-4 shadow-md",children:[(0,r.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[(0,r.jsx)("strong",{className:"font-semibold",children:"Message:"})," ",e.message]}),(0,r.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[(0,r.jsx)("strong",{className:"font-semibold",children:"Status:"})," ",e.status]}),(0,r.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[(0,r.jsx)("strong",{className:"font-semibold",children:"Time:"})," ",new Date(1e3*e.createdAt.seconds).toLocaleString()]})]},e.id))})]})]})})})},y=e=>{let{userId:t,name:a,showContactModal:s,setShowContactModal:l}=e,[i,c]=(0,o.useState)({userId:t,name:a,message:""}),[u,m]=(0,o.useState)(null),g=e=>{c({...i,[e.target.name]:e.target.value})},x=async e=>{e.preventDefault();try{await (0,n.ET)((0,n.hJ)(d.Z,"messages"),{...i,status:"pending",createdAt:new Date}),c({...i,message:""}),m("Form submitted successfully.")}catch(e){console.error("Error adding document: ",e),m("Error submitting form. Please try again.")}};return(0,r.jsx)(r.Fragment,{children:s&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-full max-w-md relative",children:[(0,r.jsx)("button",{className:"absolute top-2 right-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100",onClick:()=>l(!1),"aria-label":"Close",children:"\xd7"}),(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("form",{onSubmit:x,children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Contact Admins"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"id",className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-400",children:"ID"}),(0,r.jsx)("input",{type:"text",id:"id",name:"userId",className:"py-2 px-3 block w-full border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:border-blue-500 focus:ring-blue-500",value:i.userId,onChange:g,required:!0,disabled:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-400",children:"Name"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",className:"py-2 px-3 block w-full border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:border-blue-500 focus:ring-blue-500",value:i.name,onChange:g,required:!0,disabled:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-400",children:"Comment"}),(0,r.jsx)("textarea",{id:"message",name:"message",className:"py-2 px-3 block w-full border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 focus:border-blue-500 focus:ring-blue-500",rows:"4",value:i.message,onChange:g,required:!0})]}),(0,r.jsx)("button",{type:"submit",className:"py-2 px-4 w-full bg-blue-600 dark:bg-blue-700 text-white dark:text-gray-200 rounded-lg font-medium hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:bg-blue-700 dark:focus:bg-blue-600",children:"Submit"}),u&&(0,r.jsx)("p",{className:"mt-4 text-sm text-center text-gray-800 dark:text-gray-200",children:u})]})})]})})})},b=a(3458);a(4769);var h=(0,u.Z)(()=>{let e=(0,s.useRouter)(),[t,a]=(0,o.useState)(l.ou.now().setZone("America/Edmonton").toLocaleString(l.ou.DATETIME_FULL_WITH_SECONDS)),[i,u]=(0,o.useState)(""),[h,p]=(0,o.useState)(""),[k,f]=(0,o.useState)("15"),[w,j]=(0,o.useState)(""),[N,_]=(0,o.useState)("select"),[v,S]=(0,o.useState)([]),[I,C]=(0,o.useState)(null),[E,O]=(0,o.useState)(!1),[D,A]=(0,o.useState)(!1),[L,B]=(0,o.useState)(null),[T,M]=(0,o.useState)(0),[P,Z]=(0,o.useState)(""),[F,J]=(0,o.useState)(600),[H,U]=(0,o.useState)(!1),[z,G]=(0,o.useState)(!1),[W,q]=(0,o.useState)(!1),[R,K]=(0,o.useState)(0),Y=(0,o.useCallback)(e=>{S(a=>[...a,{time:t,message:e}])},[t]),X=(0,o.useCallback)(()=>(e.push("/"),600),[e]);(0,o.useEffect)(()=>{let e=localStorage.getItem("userName"),t=localStorage.getItem("userId");e&&u(e),t&&p(t),(async()=>{if(t){let e=(0,n.IO)((0,n.hJ)(d.Z,"employee"),(0,n.ar)("id","==",t)),a=await (0,n.PL)(e);a.empty||("online"===a.docs[0].data().status?(O(!0),(0,b.x$)(t,K)):O(!1))}})();let r=setInterval(()=>{let e=l.ou.now().setZone("America/Edmonton");a(e.toLocaleString(l.ou.DATETIME_FULL_WITH_SECONDS)),J(e=>e<=1?X():e-1),(0,b.x$)(h,K);let t=e.hour;t<12?Z("Good morning"):t<18?Z("Good afternoon"):Z("Good evening")},1e3);return()=>clearInterval(r)},[X,h]);let $=e=>{_(e.target.value),"select"===e.target.value?j(""):f("")},Q=async()=>{try{localStorage.removeItem("userName"),localStorage.removeItem("userId"),e.push("/")}catch(e){console.error("Error during logout:",e)}};return(0,r.jsx)("div",{className:"dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"container mx-auto dark:bg-gray-900",children:[(0,r.jsx)("title",{children:"MTG - Employee"}),(0,r.jsxs)("div",{className:"bg-white min-w-full dark:bg-gray-900 p-4 shadow-lg",children:[(0,r.jsxs)("h1",{className:"text-2xl text-center font-bold mb-2 text-gray-900 dark:text-gray-100",children:[P,", ",i]}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:space-x-4 mt-4",children:[(0,r.jsxs)("div",{className:"text-lg bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[(0,r.jsxs)("p",{className:"text-gray-900 dark:text-gray-100",children:["Current Time:"," ",(0,r.jsx)("span",{className:"font-semibold",children:t})]}),(0,r.jsxs)("p",{className:"text-gray-900 dark:text-gray-100",children:["Auto Logout In:"," ",(0,r.jsxs)("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:[Math.floor(F/60),":",String(F%60).padStart(2,"0")]})]}),(0,r.jsxs)("p",{className:"text-gray-900 dark:text-gray-100",children:["Today's Work Duration:"," ",(0,r.jsx)("span",{className:"font-semibold text-green-600 dark:text-green-400",children:(0,b.t1)(R)})]})]}),(0,r.jsx)("div",{className:"w-full md:w-2/3 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg",children:(0,r.jsx)(g,{})}),(0,r.jsxs)("div",{className:"w-full md:w-1/3 flex flex-col space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("button",{className:"w-full py-2 px-4 rounded ".concat(E?"bg-gray-400 dark:bg-gray-600 cursor-not-allowed":"bg-green-600 text-white"),onClick:()=>(0,b.el)(h,B,O,Y),disabled:E,children:"Clock In"}),(0,r.jsx)("button",{className:"w-full py-2 px-4 rounded ".concat(E?"bg-red-600 text-white":"bg-gray-400 dark:bg-gray-600 cursor-not-allowed"),onClick:()=>(0,b.hq)(h,O,M,Y,L,T,D,I,A),disabled:!E,children:"Clock Out"})]}),(0,r.jsx)("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-4 flex-wrap",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-[150px]",children:[(0,r.jsx)("input",{type:"radio",name:"breakOption",value:"select",checked:"select"===N,onChange:$,disabled:!E,className:"form-radio text-blue-500 dark:text-blue-400"}),(0,r.jsxs)("select",{className:"p-2 border rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 ".concat("select"===N&&E?"":"bg-gray-200 dark:bg-gray-800"),value:k,onChange:e=>{f(e.target.value),_("select")},disabled:"select"!==N||!E,children:[(0,r.jsx)("option",{value:"15",children:"15 min"}),(0,r.jsx)("option",{value:"30",children:"30 min"}),(0,r.jsx)("option",{value:"45",children:"45 min"}),(0,r.jsx)("option",{value:"60",children:"60 min"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-[150px]",children:[(0,r.jsx)("input",{type:"radio",name:"breakOption",value:"custom",checked:"custom"===N,onChange:$,disabled:!E,className:"form-radio text-blue-500 dark:text-blue-400"}),(0,r.jsx)("input",{type:"number",className:"p-2 border rounded-md dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 ".concat("custom"===N&&E?"":"bg-gray-200 dark:bg-gray-800"),placeholder:"Custom",value:w,onChange:e=>{j(e.target.value),_("custom")},disabled:"custom"!==N||!E,min:"1"})]}),(0,r.jsx)("button",{className:"flex-shrink-0 px-4 py-2 bg-blue-500 text-white rounded-md shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(!E||D?"bg-gray-400 text-gray-700 cursor-not-allowed":""),onClick:()=>{let e="select"===N?k:w;if(""===e||0===parseInt(e)){alert("Break duration must be greater than 0 and not empty.");return}(0,b.pM)(h,A,C,e,Y)},disabled:!E||D,children:"Start Break"})]})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("button",{className:"w-full py-2 px-4 bg-blue-600 dark:bg-blue-700 text-white rounded",onClick:()=>G(!0),children:"Contact Admins"}),(0,r.jsx)("button",{className:"w-full py-2 px-4 bg-blue-600 dark:bg-blue-700 text-white rounded",onClick:()=>q(!0),children:"View Sent Contact Forms"}),(0,r.jsx)("button",{className:"w-full py-2 px-4 bg-blue-600 dark:bg-blue-700 text-white rounded",onClick:()=>U(!0),children:"Change Password"})]})]})]}),(0,r.jsx)(c,{employeeId:h}),(0,r.jsx)("div",{className:"mt-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg",children:(0,r.jsxs)("table",{className:"w-full text-left text-gray-900 dark:text-gray-100",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b dark:border-gray-700",children:[(0,r.jsx)("th",{className:"py-2 px-4",children:"Time"}),(0,r.jsx)("th",{className:"py-2 px-4",children:"Message"})]})}),(0,r.jsx)("tbody",{children:v.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b dark:border-gray-700",children:[(0,r.jsx)("td",{className:"py-2 px-4",children:e.time}),(0,r.jsx)("td",{className:"py-2 px-4",children:e.message})]},t))})]})}),(0,r.jsx)("button",{className:"mt-4 w-full py-2 px-4 bg-red-600 dark:bg-red-700 text-white rounded",onClick:Q,children:"Log Out"})]}),(0,r.jsx)(m,{userId:h,showPasswordModal:H,setShowPasswordModal:U}),(0,r.jsx)(y,{userId:h,name:i,showContactModal:z,setShowContactModal:G}),(0,r.jsx)(x,{userId:h,showSentFormsModal:W,setSentFormsModal:q})]})})})},3458:function(e,t,a){"use strict";a.d(t,{t1:function(){return b},el:function(){return g},hq:function(){return x},pM:function(){return y},x$:function(){return m}});var r=a(9842),s=a(9450),o=a(5344),l=a(5871),n=a(5494);let d=()=>new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:5e3,maximumAge:6e4})}),i=async e=>{try{let t=(0,r.IO)((0,r.hJ)(o.Z,"employee"),(0,r.ar)("id","==",e)),a=await (0,r.PL)(t);if(a.empty)return console.error("No user found with the given ID"),!1;let s=a.docs[0].data().geofence;if("None"==s)return!0;if(!s)return console.error("No geofence location ID found for the user"),!1;let i=(0,r.JU)(o.Z,"geofence",s),c=await (0,r.QT)(i);if(!c.exists())return console.error("No geofence document found"),!1;let u=c.data().geopoint;if(!u||!u.latitude||!u.longitude)return console.error("Invalid geofence location data"),!1;let m=await d(),g=[m.coords.longitude,m.coords.latitude],x=(0,l.xm)(g),y=(0,l.xm)([u.longitude,u.latitude]);return 5>=(0,n.T)(y,x,{units:"kilometers"})}catch(e){return console.error("Error validating location:",e),!1}},c=null,u=(e,t)=>{c&&clearInterval(c),c=setInterval(async()=>{await m(e,t)},6e4)},m=async(e,t)=>{let a=(0,r.IO)((0,r.hJ)(o.Z,"employee"),(0,r.ar)("id","==",e)),l=await (0,r.PL)(a);if(!l.empty){let e=l.docs[0],a=(0,r.JU)(o.Z,"employee",e.id),n=e.data();if("online"===n.status){let e=s.ou.now().setZone("America/Edmonton"),o=e.toISODate(),l=n.workTime[o],d=s.ou.fromISO(l.split(" - ")[0],{zone:"America/Edmonton"}),i=n.totalBreakDuration||0,c=Math.round(e.diff(d,"minutes").minutes-i);c<0&&(c=0),t(c);let u={...n.workPeriod,[o]:c};await (0,r.r7)(a,{workDurationToday:c,workPeriod:u}),console.log("Work duration updated successfully.")}else clearInterval(c)}},g=async(e,t,a,l,n)=>{if(!await i(e)){alert("You are not within the allowed location to clock in.");return}let d=(0,r.IO)((0,r.hJ)(o.Z,"employee"),(0,r.ar)("id","==",e));try{let i=await (0,r.PL)(d);if(i.empty)console.log("User document does not exist for ID: ".concat(e));else{let d=i.docs[0],c=(0,r.JU)(o.Z,"employee",d.id),m=d.data(),g=s.ou.now().setZone("America/Edmonton"),x=g.weekdayLong,y=m.workHours[x];if(" - "===y){alert("Today is a day off, you cannot clock in.");return}let[b,h]=y.split(" - "),p=s.ou.fromISO(b,{zone:"America/Edmonton"}).minus({minutes:30}),k=s.ou.fromISO(h,{zone:"America/Edmonton"}).plus({minutes:30});if(g<p||g>k){alert("It is not within the allowed clock-in time range.");return}a(!0),t(g),l("Clocked In at ".concat(g.toLocaleString(s.ou.DATETIME_FULL_WITH_SECONDS)));let f=g.toISODate(),w={...m.workTime,[f]:g.toFormat("HH:mm")};await (0,r.r7)(c,{status:"online",workTime:w,totalBreakDuration:0,isOnBreak:!1}),console.log("User status set to online and work duration initialized."),u(e,n)}}catch(e){console.error("Error clocking in:",e)}},x=async(e,t,a,l,n)=>{t(!1);let d=s.ou.now().setZone("America/Edmonton");a("Clocked Out at ".concat(d.toLocaleString(s.ou.DATETIME_FULL_WITH_SECONDS)));let i=(0,r.IO)((0,r.hJ)(o.Z,"employee"),(0,r.ar)("id","==",e));try{let t=await (0,r.PL)(i);if(t.empty)console.log("User document does not exist for ID: ".concat(e));else{let e=t.docs[0],a=(0,r.JU)(o.Z,"employee",e.id),i=e.data(),c=d.toISODate(),u=i.workTime[c],m=s.ou.fromISO(u,{zone:"America/Edmonton"}),g=Math.round(d.diff(m,"minutes").minutes-(i.totalBreakDuration||0));g<0&&(g=0);let x=i.workPeriod[c]||0;g+=x;let y={...i.workPeriod,[c]:g},b={...i.workTime,[c]:"".concat(u," - ").concat(d.toFormat("HH:mm"))};if(await (0,r.r7)(a,{status:"offline",lastOnlineDate:c,isOnBreak:!1,workDurationToday:g,workPeriod:y,workTime:b}),d.startOf("day")>m.startOf("day")){let e=d.plus({days:1}).toISODate(),t=i.workPeriod[e]||0;await (0,r.r7)(a,{workPeriod:{...i.workPeriod,[e]:t+g}})}console.log("User status set to offline and work duration updated."),l(g),n(!1)}}catch(e){console.error("Error clocking out:",e)}},y=async(e,t,a,l,n)=>{t(!0),n("Break started at ".concat(s.ou.now().setZone("America/Edmonton").toLocaleString(s.ou.DATETIME_FULL_WITH_SECONDS)));let d=(0,r.IO)((0,r.hJ)(o.Z,"employee"),(0,r.ar)("id","==",e)),i=await (0,r.PL)(d);if(!i.empty){let e=i.docs[0],d=(0,r.JU)(o.Z,"employee",e.id),c=(e.data().totalBreakDuration||0)+parseInt(l);await (0,r.r7)(d,{isOnBreak:!0,totalBreakDuration:c}),a(setTimeout(async()=>{t(!1),n("Break ended at ".concat(s.ou.now().setZone("America/Edmonton").toLocaleString(s.ou.DATETIME_FULL_WITH_SECONDS))),await (0,r.r7)(d,{isOnBreak:!1}),a(null)},6e4*l))}},b=e=>0===e?"0 h 0 m":"".concat(Math.floor(e/60)," h ").concat(e%60," m")},5344:function(e,t,a){"use strict";var r=a(5236),s=a(9842),o=a(9854);let l=(0,r.ZF)({apiKey:"AIzaSyB5__zMeXEsk4RxME0Fg46Sz7AhqZzA9qE",authDomain:"mtg-quickyclock.firebaseapp.com",projectId:"mtg-quickyclock",storageBucket:"mtg-quickyclock.appspot.com",messagingSenderId:"865821745601",appId:"1:865821745601:web:b01221defd23ac3d338f40"}),n=(0,s.ad)(l);(0,o.cF)(l),t.Z=n},8370:function(e,t,a){"use strict";var r=a(7437),s=a(6463),o=a(2265);t.Z=e=>{let t=t=>{let a=(0,s.useRouter)();return(0,o.useEffect)(()=>{{let e=localStorage.getItem("userName"),t=localStorage.getItem("adminName");e||t||a.push("/")}},[a]),(0,r.jsx)(e,{...t})};return t.displayName="withAuth(".concat(e.displayName||e.name||"Component",")"),t}},4769:function(e){e.exports={container:"employee_container__38_MF",formContainer:"employee_formContainer__b8qtM",currentTime:"employee_currentTime__fa65a",buttonAndBreakGroup:"employee_buttonAndBreakGroup__nsAjr",buttonGroup:"employee_buttonGroup__hBnnY",clockInButton:"employee_clockInButton__zL5RK",clockOutButton:"employee_clockOutButton___OENO",changePasswordButton:"employee_changePasswordButton__2ykY_",startBreakButton:"employee_startBreakButton__KRkim",button:"employee_button__RdhaT",disabledButton:"employee_disabledButton__h46X_",breakGroup:"employee_breakGroup__6AevP",breakOption:"employee_breakOption__f249u",breakSelect:"employee_breakSelect__yDLJJ",breakInput:"employee_breakInput__uUJRy",log:"employee_log__9iUMH",logTable:"employee_logTable__oFT7h",logoutButton:"employee_logoutButton__CdvJg",passwordModal:"employee_passwordModal__8ubjX",passwordModalContent:"employee_passwordModalContent__oqHd5",formGroup:"employee_formGroup__Rojk9",passwordModalButtons:"employee_passwordModalButtons__S2Ob5",bulletinSection:"employee_bulletinSection__xP74p",bulletinHeader:"employee_bulletinHeader__DEQo2",viewAllButton:"employee_viewAllButton__hMRa1",overlay:"employee_overlay__HWJ_j",overlayContent:"employee_overlayContent__nOHlr",closeButton:"employee_closeButton__L4tlb",bulletinList:"employee_bulletinList__vbOY_",bulletinItem:"employee_bulletinItem__7GNfJ","sent-forms-container":"employee_sent-forms-container__omKX3","sent-forms-list":"employee_sent-forms-list__8lcnb","sent-form-item":"employee_sent-form-item__AKMoy"}}},function(e){e.O(0,[432,358,900,494,971,23,744],function(){return e(e.s=6611)}),_N_E=e.O()}]);